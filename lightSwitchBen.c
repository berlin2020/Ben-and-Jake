#pragma config(Sensor, S1,     sound,          sensorSoundDB)
#pragma config(Motor,  motorD,          light,         tmotorEV3_Large, PIDControl, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

//int soundLevel = 0;
void flipSwitch()
{
	resetMotorEncoder(light);

	while(getMotorEncoder(light) < 179)
	{
		motor(light) = 25;
	}
	motor(light) = 0;
}
/*
int calcSound()
{
 float totalSound = 0;
 for(int i = 0; i < 20; i++)
 {
   totalSound += SensorValue(sound);
   wait1Msec(250);
 }
 int averageSound = totalSound / 20;
 return averageSound;
}
*/
//waiting for first clap
int waitForClap(int clapCounter)
{
	while(SensorValue(sound) < 45)
	{

	}
	if(SensorValue(sound) > 45)
	{
		clapCounter ++;
		while(SensorValue(sound) > 45)
		{

		}
	}
	return clapCounter;
}
//uses for second clap;
int waitForDoubleClap(int clapCounter)
{
	clapCounter = waitForClap(clapCounter);



	resetTimer(timer1);
	while(getTimerValue(timer1) < 750)
	{
		if(SensorValue(sound) > 45)
		{
			clapCounter ++;
			while(getTimerValue(timer1) < 751)
			{
				//does nothing
			}
	  }
	}
	return clapCounter;
}
task main()
{
  //soundLevel = calcSound() + 20;
	while( true)
	{
		//displayBigTextLine(4, "Sound Level %d", soundLevel);
		int clapNum = 0;
		clapNum = waitForDoubleClap(clapNum);
		if(clapNum == 2)
		{
			flipSwitch();
		}
	}
}
